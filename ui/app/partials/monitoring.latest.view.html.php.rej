--- ui/app/partials/monitoring.latest.view.html.php	2021-01-18 21:20:45.000000000 +0500
+++ ui/app/partials/monitoring.latest.view.html.php	2021-06-20 17:28:08.374690800 +0500
@@ -157,21 +157,25 @@
 	// Row history data preparation.
 
 	if (array_key_exists($item['itemid'], $data['history'])) {
-		$last_history = (count($data['history'][$item['itemid']]) > 0) ? $data['history'][$item['itemid']][0] : null;
-		$prev_history = (count($data['history'][$item['itemid']]) > 1) ? $data['history'][$item['itemid']][1] : null;
+	//	error_log( print_r($data['history'][$item['itemid']],1));
+		$last_history = $data['history'][$item['itemid']];
+	//	$last_history = (count($data['history'][$item['itemid']]) > 0) ? $data['history'][$item['itemid']][0] : null;
+	//	$prev_history = (count($data['history'][$item['itemid']]) > 1) ? $data['history'][$item['itemid']][1] : null;
 	}
 	else {
 		$last_history = null;
-		$prev_history = null;
+	//	$prev_history = null;
 	}
 
 	if ($last_history) {
-		$last_check = zbx_date2str(DATE_TIME_FORMAT_SECONDS, $last_history['clock']);
-		$last_value = formatHistoryValue($last_history['value'], $item, false);
+		$last_check = zbx_date2str(DATE_TIME_FORMAT_SECONDS, $last_history['lastclock']);
+		if (isset($last_history['value'])) {
+			$last_value = formatHistoryValue($last_history['value'], $item, false);
+		} else $last_value = "<unknown>";
 		$change = '';
 
-		if ($prev_history && in_array($item['value_type'], [ITEM_VALUE_TYPE_FLOAT, ITEM_VALUE_TYPE_UINT64])) {
-			$history_diff = $last_history['value'] - $prev_history['value'];
+		if (isset($last_history['prev_value']) && in_array($item['value_type'], [ITEM_VALUE_TYPE_FLOAT, ITEM_VALUE_TYPE_UINT64])) {
+			$history_diff = $last_history['value'] - $last_history['prev_value'];
 
 			if ($history_diff != 0) {
 				if ($history_diff > 0) {
@@ -226,9 +230,11 @@
 		$item_trends = '';
 	}
 
-	$is_graph = ($item['value_type'] == ITEM_VALUE_TYPE_FLOAT || $item['value_type'] == ITEM_VALUE_TYPE_UINT64);
+	$is_graph = ($item['value_type'] == ITEM_VALUE_TYPE_FLOAT || 
+			     $item['value_type'] == ITEM_VALUE_TYPE_UINT64 );
 
-	$checkbox = (new CCheckBox('itemids['.$item['itemid'].']', $item['itemid']))->setEnabled($is_graph);
+	//$checkbox = (new CCheckBox('itemids['.$item['itemid'].']', $item['itemid']))->setEnabled($is_graph);
+	$checkbox = (new CCheckBox('itemids['.$item['itemid'].']', $item['itemid']))->setEnabled(1);
 
 	$item_name = (new CDiv([
 		(new CSpan($item['name_expanded']))->addClass('label'),
