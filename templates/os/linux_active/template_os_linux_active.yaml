zabbix_export:
  version: '5.2'
  date: '2020-10-23T09:41:24Z'
  groups:
    -
      name: Templates/Modules
    -
      name: 'Templates/Operating systems'
  templates:
    -
      template: 'Linux block devices by Zabbix agent active'
      name: 'Linux block devices by Zabbix agent active'
      description: 'Template tooling version used: 0.38'
      groups:
        -
          name: Templates/Modules
      applications:
        -
          name: Storage
        -
          name: 'Zabbix raw items'
      discovery_rules:
        -
          name: 'Block devices discovery'
          type: ZABBIX_ACTIVE
          key: vfs.dev.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#DEVTYPE}'
                value: disk
                formulaid: C
              -
                macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.MATCHES}'
                formulaid: B
              -
                macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: A
          item_prototypes:
            -
              name: '{#DEVNAME}: Disk average queue size (avgqu-sz)'
              type: DEPENDENT
              key: 'vfs.dev.queue_size[{#DEVNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: 'Current average disk queue, the number of requests outstanding on the disk at the time the performance data is collected.'
              application_prototypes:
                -
                  name: 'Disk {#DEVNAME}'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[10]'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.001'
              master_item:
                key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
            -
              name: '{#DEVNAME}: Disk read request avg waiting time (r_await)'
              type: CALCULATED
              key: 'vfs.dev.read.await[{#DEVNAME}]'
              history: 7d
              value_type: FLOAT
              units: '!ms'
              params: '(last("vfs.dev.read.time.rate[{#DEVNAME}]")/(last("vfs.dev.read.rate[{#DEVNAME}]")+(last("vfs.dev.read.rate[{#DEVNAME}]")=0)))*1000*(last("vfs.dev.read.rate[{#DEVNAME}]") > 0)'
              description: 'This formula contains two boolean expressions that evaluates to 1 or 0 in order to set calculated metric to zero and to avoid division by zero exception.'
              application_prototypes:
                -
                  name: 'Disk {#DEVNAME}'
            -
              name: '{#DEVNAME}: Disk read rate'
              type: DEPENDENT
              key: 'vfs.dev.read.rate[{#DEVNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '!r/s'
              description: 'r/s. The number (after merges) of read requests completed per second for the device.'
              application_prototypes:
                -
                  name: 'Disk {#DEVNAME}'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[0]'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
            -
              name: '{#DEVNAME}: Disk read time (rate)'
              type: DEPENDENT
              key: 'vfs.dev.read.time.rate[{#DEVNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: 'Rate of total read time counter. Used in r_await calculation'
              applications:
                -
                  name: 'Zabbix raw items'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[3]'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.001'
              master_item:
                key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
            -
              name: '{#DEVNAME}: Disk utilization'
              type: DEPENDENT
              key: 'vfs.dev.util[{#DEVNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: 'This item is the percentage of elapsed time that the selected disk drive was busy servicing read or writes requests.'
              application_prototypes:
                -
                  name: 'Disk {#DEVNAME}'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[9]'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.1'
              master_item:
                key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
            -
              name: '{#DEVNAME}: Disk write request avg waiting time (w_await)'
              type: CALCULATED
              key: 'vfs.dev.write.await[{#DEVNAME}]'
              history: 7d
              value_type: FLOAT
              units: '!ms'
              params: '(last("vfs.dev.write.time.rate[{#DEVNAME}]")/(last("vfs.dev.write.rate[{#DEVNAME}]")+(last("vfs.dev.write.rate[{#DEVNAME}]")=0)))*1000*(last("vfs.dev.write.rate[{#DEVNAME}]") > 0)'
              description: 'This formula contains two boolean expressions that evaluates to 1 or 0 in order to set calculated metric to zero and to avoid division by zero exception.'
              application_prototypes:
                -
                  name: 'Disk {#DEVNAME}'
            -
              name: '{#DEVNAME}: Disk write rate'
              type: DEPENDENT
              key: 'vfs.dev.write.rate[{#DEVNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '!w/s'
              description: 'w/s. The number (after merges) of write requests completed per second for the device.'
              application_prototypes:
                -
                  name: 'Disk {#DEVNAME}'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[4]'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
            -
              name: '{#DEVNAME}: Disk write time (rate)'
              type: DEPENDENT
              key: 'vfs.dev.write.time.rate[{#DEVNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: 'Rate of total write time counter. Used in w_await calculation'
              applications:
                -
                  name: 'Zabbix raw items'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[7]'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.001'
              master_item:
                key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
            -
              name: '{#DEVNAME}: Get stats'
              type: ZABBIX_ACTIVE
              key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
              history: '0'
              trends: '0'
              value_type: TEXT
              description: 'Get contents of /sys/block/{#DEVNAME}/stat for disk stats.'
              applications:
                -
                  name: 'Zabbix raw items'
              preprocessing:
                -
                  type: JAVASCRIPT
                  parameters:
                    - 'return JSON.stringify(value.trim().split(/ +/));'
          trigger_prototypes:
            -
              expression: '{Linux block devices by Zabbix agent active:vfs.dev.read.await[{#DEVNAME}].min(15m)} > {$VFS.DEV.READ.AWAIT.WARN:"{#DEVNAME}"} or {Linux block devices by Zabbix agent active:vfs.dev.write.await[{#DEVNAME}].min(15m)} > {$VFS.DEV.WRITE.AWAIT.WARN:"{#DEVNAME}"}'
              name: '{#DEVNAME}: Disk read/write request responses are too high (read > {$VFS.DEV.READ.AWAIT.WARN:"{#DEVNAME}"} ms for 15m or write > {$VFS.DEV.WRITE.AWAIT.WARN:"{#DEVNAME}"} ms for 15m)'
              priority: WARNING
              description: 'This trigger might indicate disk {#DEVNAME} saturation.'
              manual_close: 'YES'
          graph_prototypes:
            -
              name: '{#DEVNAME}: Disk average waiting time'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'Linux block devices by Zabbix agent active'
                    key: 'vfs.dev.read.await[{#DEVNAME}]'
                -
                  sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: 2774A4
                  item:
                    host: 'Linux block devices by Zabbix agent active'
                    key: 'vfs.dev.write.await[{#DEVNAME}]'
            -
              name: '{#DEVNAME}: Disk read/write rates'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'Linux block devices by Zabbix agent active'
                    key: 'vfs.dev.read.rate[{#DEVNAME}]'
                -
                  sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: 2774A4
                  item:
                    host: 'Linux block devices by Zabbix agent active'
                    key: 'vfs.dev.write.rate[{#DEVNAME}]'
            -
              name: '{#DEVNAME}: Disk utilization and queue'
              graph_items:
                -
                  color: 1A7C11
                  yaxisside: RIGHT
                  item:
                    host: 'Linux block devices by Zabbix agent active'
                    key: 'vfs.dev.queue_size[{#DEVNAME}]'
                -
                  sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: 2774A4
                  item:
                    host: 'Linux block devices by Zabbix agent active'
                    key: 'vfs.dev.util[{#DEVNAME}]'
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
      macros:
        -
          macro: '{$VFS.DEV.DEVNAME.MATCHES}'
          value: .+
          description: 'This macro is used in block devices discovery. Can be overridden on the host or linked template level'
        -
          macro: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
          value: '^(loop[0-9]*|sd[a-z][0-9]+|nbd[0-9]+|sr[0-9]+|fd[0-9]+|dm-[0-9]+|ram[0-9]+|ploop[a-z0-9]+|md[0-9]*|hcp[0-9]*|zram[0-9]*)'
          description: 'This macro is used in block devices discovery. Can be overridden on the host or linked template level'
        -
          macro: '{$VFS.DEV.READ.AWAIT.WARN}'
          value: '20'
          description: 'Disk read average response time (in ms) before the trigger would fire'
        -
          macro: '{$VFS.DEV.WRITE.AWAIT.WARN}'
          value: '20'
          description: 'Disk write average response time (in ms) before the trigger would fire'
    -
      template: 'Linux by Zabbix agent active'
      name: 'Linux by Zabbix agent active'
      description: |
        Official Linux template. Requires agent of Zabbix 3.0.14, 3.4.5 and 4.0.0 or newer.
        
        Known Issues:
        
          Description: Network discovery. Zabbix agent as of 4.2 doesn't support items such as net.if.status, net.if.speed.
        
        You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/387225-discussion-thread-for-official-zabbix-template-for-linux
        
        Template tooling version used: 0.38
      templates:
        -
          name: 'Linux block devices by Zabbix agent active'
        -
          name: 'Linux CPU by Zabbix agent active'
        -
          name: 'Linux filesystems by Zabbix agent active'
        -
          name: 'Linux generic by Zabbix agent active'
        -
          name: 'Linux memory by Zabbix agent active'
        -
          name: 'Linux network interfaces by Zabbix agent active'
        -
          name: 'Zabbix agent'
      groups:
        -
          name: 'Templates/Operating systems'
      dashboards:
        -
          name: 'System performance'
          widgets:
            -
              type: GRAPH_CLASSIC
              width: '12'
              height: '5'
              fields:
                -
                  type: INTEGER
                  name: source_type
                  value: '0'
                -
                  type: GRAPH
                  name: graphid
                  value:
                    name: 'System load'
                    host: 'Linux by Zabbix agent active'
            -
              type: GRAPH_CLASSIC
              x: '12'
              width: '12'
              height: '5'
              fields:
                -
                  type: INTEGER
                  name: source_type
                  value: '0'
                -
                  type: GRAPH
                  name: graphid
                  value:
                    name: 'CPU usage'
                    host: 'Linux by Zabbix agent active'
            -
              type: GRAPH_CLASSIC
              'y': '5'
              width: '12'
              height: '5'
              fields:
                -
                  type: INTEGER
                  name: source_type
                  value: '0'
                -
                  type: GRAPH
                  name: graphid
                  value:
                    name: 'Memory usage'
                    host: 'Linux by Zabbix agent active'
            -
              type: GRAPH_CLASSIC
              x: '12'
              'y': '5'
              width: '12'
              height: '5'
              fields:
                -
                  type: INTEGER
                  name: source_type
                  value: '0'
                -
                  type: GRAPH
                  name: graphid
                  value:
                    name: 'Swap usage'
                    host: 'Linux by Zabbix agent active'
            -
              type: GRAPH_PROTOTYPE
              'y': '10'
              width: '24'
              height: '5'
              fields:
                -
                  type: INTEGER
                  name: columns
                  value: '1'
                -
                  type: INTEGER
                  name: rows
                  value: '1'
                -
                  type: INTEGER
                  name: source_type
                  value: '2'
                -
                  type: GRAPH_PROTOTYPE
                  name: graphid
                  value:
                    name: '{#FSNAME}: Disk space usage'
                    host: 'Linux by Zabbix agent active'
            -
              type: GRAPH_PROTOTYPE
              'y': '15'
              width: '24'
              height: '5'
              fields:
                -
                  type: INTEGER
                  name: columns
                  value: '1'
                -
                  type: INTEGER
                  name: rows
                  value: '1'
                -
                  type: INTEGER
                  name: source_type
                  value: '2'
                -
                  type: GRAPH_PROTOTYPE
                  name: graphid
                  value:
                    name: '{#DEVNAME}: Disk read/write rates'
                    host: 'Linux by Zabbix agent active'
            -
              type: GRAPH_PROTOTYPE
              'y': '20'
              width: '24'
              height: '5'
              fields:
                -
                  type: INTEGER
                  name: columns
                  value: '1'
                -
                  type: INTEGER
                  name: rows
                  value: '1'
                -
                  type: INTEGER
                  name: source_type
                  value: '2'
                -
                  type: GRAPH_PROTOTYPE
                  name: graphid
                  value:
                    name: '{#DEVNAME}: Disk average waiting time'
                    host: 'Linux by Zabbix agent active'
            -
              type: GRAPH_PROTOTYPE
              'y': '25'
              width: '24'
              height: '5'
              fields:
                -
                  type: INTEGER
                  name: columns
                  value: '1'
                -
                  type: INTEGER
                  name: rows
                  value: '1'
                -
                  type: INTEGER
                  name: source_type
                  value: '2'
                -
                  type: GRAPH_PROTOTYPE
                  name: graphid
                  value:
                    name: '{#DEVNAME}: Disk utilization and queue'
                    host: 'Linux by Zabbix agent active'
            -
              type: GRAPH_PROTOTYPE
              'y': '30'
              width: '24'
              height: '5'
              fields:
                -
                  type: INTEGER
                  name: columns
                  value: '1'
                -
                  type: INTEGER
                  name: rows
                  value: '1'
                -
                  type: INTEGER
                  name: source_type
                  value: '2'
                -
                  type: GRAPH_PROTOTYPE
                  name: graphid
                  value:
                    name: 'Interface {#IFNAME}: Network traffic'
                    host: 'Linux by Zabbix agent active'
    -
      template: 'Linux CPU by Zabbix agent active'
      name: 'Linux CPU by Zabbix agent active'
      description: 'Template tooling version used: 0.38'
      groups:
        -
          name: Templates/Modules
      applications:
        -
          name: CPU
      items:
        -
          name: 'Interrupts per second'
          type: ZABBIX_ACTIVE
          key: system.cpu.intr
          history: 7d
          value_type: FLOAT
          applications:
            -
              name: CPU
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
        -
          name: 'Load average (1m avg)'
          type: ZABBIX_ACTIVE
          key: 'system.cpu.load[all,avg1]'
          history: 7d
          value_type: FLOAT
          applications:
            -
              name: CPU
        -
          name: 'Load average (5m avg)'
          type: ZABBIX_ACTIVE
          key: 'system.cpu.load[all,avg5]'
          history: 7d
          value_type: FLOAT
          applications:
            -
              name: CPU
        -
          name: 'Load average (15m avg)'
          type: ZABBIX_ACTIVE
          key: 'system.cpu.load[all,avg15]'
          history: 7d
          value_type: FLOAT
          applications:
            -
              name: CPU
        -
          name: 'Number of CPUs'
          type: ZABBIX_ACTIVE
          key: system.cpu.num
          history: 7d
          applications:
            -
              name: CPU
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
        -
          name: 'Context switches per second'
          type: ZABBIX_ACTIVE
          key: system.cpu.switches
          history: 7d
          value_type: FLOAT
          applications:
            -
              name: CPU
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
        -
          name: 'CPU utilization'
          type: DEPENDENT
          key: system.cpu.util
          delay: '0'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'CPU utilization in %'
          applications:
            -
              name: CPU
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  //Calculate utilization
                  return (100 - value)
          master_item:
            key: 'system.cpu.util[,idle]'
          triggers:
            -
              expression: '{min(5m)}>{$CPU.UTIL.CRIT}'
              name: 'High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'CPU utilization is too high. The system might be slow to respond.'
              dependencies:
                -
                  name: 'Load average is too high (per CPU load over {$LOAD_AVG_PER_CPU.MAX.WARN} for 5m)'
                  expression: |
                    {Linux CPU by Zabbix agent active:system.cpu.load[all,avg1].min(5m)}/{Linux CPU by Zabbix agent active:system.cpu.num.last()}>{$LOAD_AVG_PER_CPU.MAX.WARN}
                    and {Linux CPU by Zabbix agent active:system.cpu.load[all,avg5].last()}>0
                    and {Linux CPU by Zabbix agent active:system.cpu.load[all,avg15].last()}>0
        -
          name: 'CPU guest time'
          type: ZABBIX_ACTIVE
          key: 'system.cpu.util[,guest]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'Guest  time (time  spent  running  a  virtual  CPU  for  a  guest  operating  system)'
          applications:
            -
              name: CPU
        -
          name: 'CPU guest nice time'
          type: ZABBIX_ACTIVE
          key: 'system.cpu.util[,guest_nice]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'Time spent running a niced guest (virtual CPU for guest operating systems under the control of the Linux kernel)'
          applications:
            -
              name: CPU
        -
          name: 'CPU idle time'
          type: ZABBIX_ACTIVE
          key: 'system.cpu.util[,idle]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The time the CPU has spent doing nothing.'
          applications:
            -
              name: CPU
        -
          name: 'CPU interrupt time'
          type: ZABBIX_ACTIVE
          key: 'system.cpu.util[,interrupt]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The amount of time the CPU has been servicing hardware interrupts.'
          applications:
            -
              name: CPU
        -
          name: 'CPU iowait time'
          type: ZABBIX_ACTIVE
          key: 'system.cpu.util[,iowait]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'Amount of time the CPU has been waiting for I/O to complete.'
          applications:
            -
              name: CPU
        -
          name: 'CPU nice time'
          type: ZABBIX_ACTIVE
          key: 'system.cpu.util[,nice]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The time the CPU has spent running users'' processes that have been niced.'
          applications:
            -
              name: CPU
        -
          name: 'CPU softirq time'
          type: ZABBIX_ACTIVE
          key: 'system.cpu.util[,softirq]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The amount of time the CPU has been servicing software interrupts.'
          applications:
            -
              name: CPU
        -
          name: 'CPU steal time'
          type: ZABBIX_ACTIVE
          key: 'system.cpu.util[,steal]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The amount of CPU ''stolen'' from this virtual machine by the hypervisor for other tasks (such as running another virtual machine).'
          applications:
            -
              name: CPU
        -
          name: 'CPU system time'
          type: ZABBIX_ACTIVE
          key: 'system.cpu.util[,system]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The time the CPU has spent running the kernel and its processes.'
          applications:
            -
              name: CPU
        -
          name: 'CPU user time'
          type: ZABBIX_ACTIVE
          key: 'system.cpu.util[,user]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The time the CPU has spent running users'' processes that are not niced.'
          applications:
            -
              name: CPU
      macros:
        -
          macro: '{$CPU.UTIL.CRIT}'
          value: '90'
        -
          macro: '{$LOAD_AVG_PER_CPU.MAX.WARN}'
          value: '1.5'
          description: 'Load per CPU considered sustainable. Tune if needed.'
    -
      template: 'Linux filesystems by Zabbix agent active'
      name: 'Linux filesystems by Zabbix agent active'
      description: 'Template tooling version used: 0.38'
      groups:
        -
          name: Templates/Modules
      applications:
        -
          name: Filesystems
      discovery_rules:
        -
          name: 'Mounted filesystem discovery'
          type: ZABBIX_ACTIVE
          key: vfs.fs.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#FSTYPE}'
                value: '{$VFS.FS.FSTYPE.MATCHES}'
                formulaid: C
              -
                macro: '{#FSTYPE}'
                value: '{$VFS.FS.FSTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              -
                macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.MATCHES}'
                formulaid: A
              -
                macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'Discovery of file systems of different types.'
          item_prototypes:
            -
              name: '{#FSNAME}: Free inodes in %'
              type: ZABBIX_ACTIVE
              key: 'vfs.fs.inode[{#FSNAME},pfree]'
              history: 7d
              value_type: FLOAT
              units: '%'
              application_prototypes:
                -
                  name: 'Filesystem {#FSNAME}'
              trigger_prototypes:
                -
                  expression: '{min(5m)}<{$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}'
                  name: '{#FSNAME}: Running out of free inodes (free < {$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}%)'
                  opdata: 'Free inodes: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    It may become impossible to write to disk if there are no index nodes left.
                    As symptoms, 'No space left on device' or 'Disk is full' errors may be seen even though free space is available.
                -
                  expression: '{min(5m)}<{$VFS.FS.INODE.PFREE.MIN.WARN:"{#FSNAME}"}'
                  name: '{#FSNAME}: Running out of free inodes (free < {$VFS.FS.INODE.PFREE.MIN.WARN:"{#FSNAME}"}%)'
                  opdata: 'Free inodes: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: |
                    It may become impossible to write to disk if there are no index nodes left.
                    As symptoms, 'No space left on device' or 'Disk is full' errors may be seen even though free space is available.
                  dependencies:
                    -
                      name: '{#FSNAME}: Running out of free inodes (free < {$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}%)'
                      expression: '{Linux filesystems by Zabbix agent active:vfs.fs.inode[{#FSNAME},pfree].min(5m)}<{$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}'
            -
              name: '{#FSNAME}: Space utilization'
              type: ZABBIX_ACTIVE
              key: 'vfs.fs.size[{#FSNAME},pused]'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: 'Space utilization in % for {#FSNAME}'
              application_prototypes:
                -
                  name: 'Filesystem {#FSNAME}'
            -
              name: '{#FSNAME}: Total space'
              type: ZABBIX_ACTIVE
              key: 'vfs.fs.size[{#FSNAME},total]'
              history: 7d
              units: B
              description: 'Total space in Bytes'
              application_prototypes:
                -
                  name: 'Filesystem {#FSNAME}'
            -
              name: '{#FSNAME}: Used space'
              type: ZABBIX_ACTIVE
              key: 'vfs.fs.size[{#FSNAME},used]'
              history: 7d
              units: B
              description: 'Used storage in Bytes'
              application_prototypes:
                -
                  name: 'Filesystem {#FSNAME}'
          trigger_prototypes:
            -
              expression: |
                {Linux filesystems by Zabbix agent active:vfs.fs.size[{#FSNAME},pused].last()}>{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"} and
                (({Linux filesystems by Zabbix agent active:vfs.fs.size[{#FSNAME},total].last()}-{Linux filesystems by Zabbix agent active:vfs.fs.size[{#FSNAME},used].last()})<5G or {Linux filesystems by Zabbix agent active:vfs.fs.size[{#FSNAME},pused].timeleft(1h,,100)}<1d)
              name: '{#FSNAME}: Disk space is critically low (used > {$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}%)'
              opdata: 'Space used: {ITEM.LASTVALUE3} of {ITEM.LASTVALUE2} ({ITEM.LASTVALUE1})'
              priority: AVERAGE
              description: |
                Two conditions should match: First, space utilization should be above {$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}.
                 Second condition should be one of the following:
                 - The disk free space is less than 5G.
                 - The disk will be full in less than 24 hours.
              manual_close: 'YES'
            -
              expression: |
                {Linux filesystems by Zabbix agent active:vfs.fs.size[{#FSNAME},pused].last()}>{$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"} and
                (({Linux filesystems by Zabbix agent active:vfs.fs.size[{#FSNAME},total].last()}-{Linux filesystems by Zabbix agent active:vfs.fs.size[{#FSNAME},used].last()})<10G or {Linux filesystems by Zabbix agent active:vfs.fs.size[{#FSNAME},pused].timeleft(1h,,100)}<1d)
              name: '{#FSNAME}: Disk space is low (used > {$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"}%)'
              opdata: 'Space used: {ITEM.LASTVALUE3} of {ITEM.LASTVALUE2} ({ITEM.LASTVALUE1})'
              priority: WARNING
              description: |
                Two conditions should match: First, space utilization should be above {$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"}.
                 Second condition should be one of the following:
                 - The disk free space is less than 10G.
                 - The disk will be full in less than 24 hours.
              manual_close: 'YES'
              dependencies:
                -
                  name: '{#FSNAME}: Disk space is critically low (used > {$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}%)'
                  expression: |
                    {Linux filesystems by Zabbix agent active:vfs.fs.size[{#FSNAME},pused].last()}>{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"} and
                    (({Linux filesystems by Zabbix agent active:vfs.fs.size[{#FSNAME},total].last()}-{Linux filesystems by Zabbix agent active:vfs.fs.size[{#FSNAME},used].last()})<5G or {Linux filesystems by Zabbix agent active:vfs.fs.size[{#FSNAME},pused].timeleft(1h,,100)}<1d)
          graph_prototypes:
            -
              name: '{#FSNAME}: Disk space usage'
              width: '600'
              height: '340'
              type: PIE
              show_3d: 'YES'
              graph_items:
                -
                  color: '969696'
                  calc_fnc: LAST
                  type: GRAPH_SUM
                  item:
                    host: 'Linux filesystems by Zabbix agent active'
                    key: 'vfs.fs.size[{#FSNAME},total]'
                -
                  sortorder: '1'
                  color: C80000
                  calc_fnc: LAST
                  item:
                    host: 'Linux filesystems by Zabbix agent active'
                    key: 'vfs.fs.size[{#FSNAME},used]'
      macros:
        -
          macro: '{$VFS.FS.FSNAME.MATCHES}'
          value: .+
          description: 'This macro is used in filesystems discovery. Can be overridden on the host or linked template level'
        -
          macro: '{$VFS.FS.FSNAME.NOT_MATCHES}'
          value: ^(/dev|/sys|/run|/proc|.+/shm$)
          description: 'This macro is used in filesystems discovery. Can be overridden on the host or linked template level'
        -
          macro: '{$VFS.FS.FSTYPE.MATCHES}'
          value: ^(btrfs|ext2|ext3|ext4|reiser|xfs|ffs|ufs|jfs|jfs2|vxfs|hfs|apfs|refs|ntfs|fat32|zfs)$
          description: 'This macro is used in filesystems discovery. Can be overridden on the host or linked template level'
        -
          macro: '{$VFS.FS.FSTYPE.NOT_MATCHES}'
          value: ^\s$
          description: 'This macro is used in filesystems discovery. Can be overridden on the host or linked template level'
        -
          macro: '{$VFS.FS.INODE.PFREE.MIN.CRIT}'
          value: '10'
        -
          macro: '{$VFS.FS.INODE.PFREE.MIN.WARN}'
          value: '20'
        -
          macro: '{$VFS.FS.PUSED.MAX.CRIT}'
          value: '90'
        -
          macro: '{$VFS.FS.PUSED.MAX.WARN}'
          value: '80'
    -
      template: 'Linux generic by Zabbix agent active'
      name: 'Linux generic by Zabbix agent active'
      description: 'Template tooling version used: 0.38'
      groups:
        -
          name: Templates/Modules
      applications:
        -
          name: General
        -
          name: Inventory
        -
          name: Security
        -
          name: Status
      items:
        -
          name: 'Maximum number of open file descriptors'
          type: ZABBIX_ACTIVE
          key: kernel.maxfiles
          delay: 1h
          history: 7d
          description: 'It could be increased by using sysctrl utility or modifying file /etc/sysctl.conf.'
          applications:
            -
              name: General
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          triggers:
            -
              expression: '{last()}<{$KERNEL.MAXFILES.MIN}'
              name: 'Configured max number of open filedescriptors is too low (< {$KERNEL.MAXFILES.MIN})'
              priority: INFO
        -
          name: 'Maximum number of processes'
          type: ZABBIX_ACTIVE
          key: kernel.maxproc
          delay: 1h
          history: 7d
          description: 'It could be increased by using sysctrl utility or modifying file /etc/sysctl.conf.'
          applications:
            -
              name: General
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          triggers:
            -
              expression: '{last()}<{$KERNEL.MAXPROC.MIN}'
              name: 'Configured max number of processes is too low (< {$KERNEL.MAXPROC.MIN})'
              priority: INFO
              dependencies:
                -
                  name: 'Getting closer to process limit (over 80% used)'
                  expression: '{Linux generic by Zabbix agent active:proc.num.last()}/{Linux generic by Zabbix agent active:kernel.maxproc.last()}*100>80'
        -
          name: 'Number of processes'
          type: ZABBIX_ACTIVE
          key: proc.num
          history: 7d
          applications:
            -
              name: General
        -
          name: 'Number of running processes'
          type: ZABBIX_ACTIVE
          key: 'proc.num[,,run]'
          history: 7d
          applications:
            -
              name: General
        -
          name: 'System boot time'
          type: ZABBIX_ACTIVE
          key: system.boottime
          delay: 15m
          history: 7d
          units: unixtime
          applications:
            -
              name: General
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        -
          name: 'System name'
          type: ZABBIX_ACTIVE
          key: system.hostname
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'System host name.'
          inventory_link: NAME
          applications:
            -
              name: General
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          triggers:
            -
              expression: '{diff()}=1 and {strlen()}>0'
              name: 'System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'System name has changed. Ack to close.'
              manual_close: 'YES'
        -
          name: 'System local time'
          key: system.localtime
          history: 7d
          status: DISABLED
          units: unixtime
          description: 'System local time of the host.'
          applications:
            -
              name: General
          triggers:
            -
              expression: '{fuzzytime({$SYSTEM.FUZZYTIME.MAX})}=0'
              name: 'System time is out of sync (diff with Zabbix server > {$SYSTEM.FUZZYTIME.MAX}s)'
              priority: WARNING
              description: 'The host system time is different from the Zabbix server time.'
              manual_close: 'YES'
        -
          name: 'Operating system architecture'
          type: ZABBIX_ACTIVE
          key: system.sw.arch
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'Operating system architecture of the host.'
          applications:
            -
              name: Inventory
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
        -
          name: 'Operating system'
          type: ZABBIX_ACTIVE
          key: system.sw.os
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          inventory_link: OS
          applications:
            -
              name: Inventory
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          triggers:
            -
              expression: '{diff()}=1 and {strlen()}>0'
              name: 'Operating system description has changed'
              priority: INFO
              description: 'Operating system description has changed. Possible reasons that system has been updated or replaced. Ack to close.'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'System name has changed (new name: {ITEM.VALUE})'
                  expression: '{Linux generic by Zabbix agent active:system.hostname.diff()}=1 and {Linux generic by Zabbix agent active:system.hostname.strlen()}>0'
        -
          name: 'Software installed'
          type: ZABBIX_ACTIVE
          key: system.sw.packages
          delay: 1h
          history: 2w
          trends: '0'
          value_type: TEXT
          applications:
            -
              name: Inventory
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
        -
          name: 'System description'
          type: ZABBIX_ACTIVE
          key: system.uname
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'The information as normally returned by ''uname -a''.'
          applications:
            -
              name: General
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
        -
          name: 'System uptime'
          type: ZABBIX_ACTIVE
          key: system.uptime
          delay: 30s
          history: 2w
          trends: 0d
          units: uptime
          description: 'System uptime in ''N days, hh:mm:ss'' format.'
          applications:
            -
              name: Status
          triggers:
            -
              expression: '{last()}<10m'
              name: '{HOST.NAME} has been restarted (uptime < 10m)'
              priority: WARNING
              description: 'The host uptime is less than 10 minutes'
              manual_close: 'YES'
        -
          name: 'Number of logged in users'
          type: ZABBIX_ACTIVE
          key: system.users.num
          history: 7d
          description: 'Number of users who are currently logged in.'
          applications:
            -
              name: General
        -
          name: 'Checksum of /etc/passwd'
          type: ZABBIX_ACTIVE
          key: 'vfs.file.cksum[/etc/passwd]'
          delay: 15m
          history: 7d
          trends: '0'
          value_type: CHAR
          applications:
            -
              name: Security
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          triggers:
            -
              expression: '{diff()}>0'
              name: '/etc/passwd has been changed'
              priority: INFO
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Operating system description has changed'
                  expression: '{Linux generic by Zabbix agent active:system.sw.os.diff()}=1 and {Linux generic by Zabbix agent active:system.sw.os.strlen()}>0'
                -
                  name: 'System name has changed (new name: {ITEM.VALUE})'
                  expression: '{Linux generic by Zabbix agent active:system.hostname.diff()}=1 and {Linux generic by Zabbix agent active:system.hostname.strlen()}>0'
      macros:
        -
          macro: '{$KERNEL.MAXFILES.MIN}'
          value: '256'
        -
          macro: '{$KERNEL.MAXPROC.MIN}'
          value: '1024'
        -
          macro: '{$SYSTEM.FUZZYTIME.MAX}'
          value: '60'
    -
      template: 'Linux memory by Zabbix agent active'
      name: 'Linux memory by Zabbix agent active'
      description: 'Template tooling version used: 0.38'
      groups:
        -
          name: Templates/Modules
      applications:
        -
          name: Memory
      items:
        -
          name: 'Free swap space'
          type: ZABBIX_ACTIVE
          key: 'system.swap.size[,free]'
          history: 7d
          units: B
          description: 'The free space of swap volume/file in bytes.'
          applications:
            -
              name: Memory
        -
          name: 'Free swap space in %'
          type: ZABBIX_ACTIVE
          key: 'system.swap.size[,pfree]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The free space of swap volume/file in percent.'
          applications:
            -
              name: Memory
        -
          name: 'Total swap space'
          type: ZABBIX_ACTIVE
          key: 'system.swap.size[,total]'
          history: 7d
          units: B
          description: 'The total space of swap volume/file in bytes.'
          applications:
            -
              name: Memory
        -
          name: 'Available memory'
          type: ZABBIX_ACTIVE
          key: 'vm.memory.size[available]'
          history: 7d
          units: B
          description: 'Available memory, in Linux, available = free + buffers + cache. On other platforms calculation may vary. See also: https://www.zabbix.com/documentation/current/manual/appendix/items/vm.memory.size_params'
          applications:
            -
              name: Memory
        -
          name: 'Available memory in %'
          type: ZABBIX_ACTIVE
          key: 'vm.memory.size[pavailable]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'Available memory as percentage of total. See also: https://www.zabbix.com/documentation/current/manual/appendix/items/vm.memory.size_params'
          applications:
            -
              name: Memory
        -
          name: 'Total memory'
          type: ZABBIX_ACTIVE
          key: 'vm.memory.size[total]'
          history: 7d
          units: B
          description: 'Total memory in Bytes'
          applications:
            -
              name: Memory
        -
          name: 'Memory utilization'
          type: DEPENDENT
          key: vm.memory.utilization
          delay: '0'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'Memory used percentage is calculated as (100-pavailable)'
          applications:
            -
              name: Memory
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - 'return (100-value);'
          master_item:
            key: 'vm.memory.size[pavailable]'
          triggers:
            -
              expression: '{min(5m)}>{$MEMORY.UTIL.MAX}'
              name: 'High memory utilization ( >{$MEMORY.UTIL.MAX}% for 5m)'
              priority: AVERAGE
              description: 'The system is running out of free memory.'
              dependencies:
                -
                  name: 'Lack of available memory ( < {$MEMORY.AVAILABLE.MIN} of {ITEM.VALUE2})'
                  expression: '{Linux memory by Zabbix agent active:vm.memory.size[available].min(5m)}<{$MEMORY.AVAILABLE.MIN} and {Linux memory by Zabbix agent active:vm.memory.size[total].last()}>0'
      macros:
        -
          macro: '{$MEMORY.AVAILABLE.MIN}'
          value: 20M
          description: 'This macro is used as a threshold in memory available trigger.'
        -
          macro: '{$MEMORY.UTIL.MAX}'
          value: '90'
          description: 'This macro is used as a threshold in memory utilization trigger.'
        -
          macro: '{$SWAP.PFREE.MIN.WARN}'
          value: '50'
    -
      template: 'Linux network interfaces by Zabbix agent active'
      name: 'Linux network interfaces by Zabbix agent active'
      description: |
        Known Issues:
        
          Description: High interface utilization trigger is removed since currently it is not possible to retrieve interface speed to determine the max bandwidth.
        
        Template tooling version used: 0.38
      groups:
        -
          name: Templates/Modules
      applications:
        -
          name: 'Network interfaces'
      discovery_rules:
        -
          name: 'Network interface discovery'
          type: ZABBIX_ACTIVE
          key: net.if.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
                formulaid: A
              -
                macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'Discovery of network interfaces.'
          item_prototypes:
            -
              name: 'Interface {#IFNAME}: Inbound packets discarded'
              type: ZABBIX_ACTIVE
              key: 'net.if.in["{#IFNAME}",dropped]'
              delay: 3m
              history: 7d
              application_prototypes:
                -
                  name: 'Interface {#IFNAME}'
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
            -
              name: 'Interface {#IFNAME}: Inbound packets with errors'
              type: ZABBIX_ACTIVE
              key: 'net.if.in["{#IFNAME}",errors]'
              delay: 3m
              history: 7d
              application_prototypes:
                -
                  name: 'Interface {#IFNAME}'
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
            -
              name: 'Interface {#IFNAME}: Bits received'
              type: ZABBIX_ACTIVE
              key: 'net.if.in["{#IFNAME}"]'
              delay: 3m
              history: 7d
              units: bps
              application_prototypes:
                -
                  name: 'Interface {#IFNAME}'
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
            -
              name: 'Interface {#IFNAME}: Outbound packets discarded'
              type: ZABBIX_ACTIVE
              key: 'net.if.out["{#IFNAME}",dropped]'
              delay: 3m
              history: 7d
              application_prototypes:
                -
                  name: 'Interface {#IFNAME}'
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
            -
              name: 'Interface {#IFNAME}: Outbound packets with errors'
              type: ZABBIX_ACTIVE
              key: 'net.if.out["{#IFNAME}",errors]'
              delay: 3m
              history: 7d
              application_prototypes:
                -
                  name: 'Interface {#IFNAME}'
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
            -
              name: 'Interface {#IFNAME}: Bits sent'
              type: ZABBIX_ACTIVE
              key: 'net.if.out["{#IFNAME}"]'
              delay: 3m
              history: 7d
              units: bps
              application_prototypes:
                -
                  name: 'Interface {#IFNAME}'
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
            -
              name: 'Interface {#IFNAME}: Operational status'
              type: ZABBIX_ACTIVE
              key: 'vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"]'
              history: 7d
              trends: '0'
              description: |
                Indicates the interface RFC2863 operational state as a string.
                Possible values are:"unknown", "notpresent", "down", "lowerlayerdown", "testing","dormant", "up".
                Reference: https://www.kernel.org/doc/Documentation/ABI/testing/sysfs-class-net
              application_prototypes:
                -
                  name: 'Interface {#IFNAME}'
              valuemap:
                name: 'IF-MIB::ifOperStatus'
              preprocessing:
                -
                  type: JAVASCRIPT
                  parameters:
                    - |
                      var newvalue;
                      switch(value) {
                        case "up":
                          newvalue = 1;
                          break;
                        case "down":
                          newvalue = 2;
                          break;
                        case "testing":
                          newvalue = 4;
                          break;
                        case "unknown":
                          newvalue = 5;
                          break;
                        case "dormant":
                          newvalue = 6;
                          break;
                        case "notPresent":
                          newvalue = 7;
                          break;
                        default:
                          newvalue = "Problem parsing interface operstate in JS";
                      }
                      return newvalue;
              trigger_prototypes:
                -
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and ({last()}=2 and {diff()}=1)'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: '{last()}<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Interface {#IFNAME}: Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. Can be triggered if operations status is down.
                    2. {$IFCONTROL:"{#IFNAME}"}=1 - user can redefine Context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.
                    3. {TEMPLATE_NAME:METRIC.diff()}=1) - trigger fires only if operational status was up(1) sometime before. (So, do not fire 'ethernal off' interfaces.)
                    
                    WARNING: if closed manually - won't fire again on next poll, because of .diff.
                  manual_close: 'YES'
            -
              name: 'Interface {#IFNAME}: Interface type'
              type: ZABBIX_ACTIVE
              key: 'vfs.file.contents["/sys/class/net/{#IFNAME}/type"]'
              delay: 1h
              history: 7d
              trends: 0d
              description: |
                Indicates the interface protocol type as a decimal value.
                See include/uapi/linux/if_arp.h for all possible values.
                Reference: https://www.kernel.org/doc/Documentation/ABI/testing/sysfs-class-net
              application_prototypes:
                -
                  name: 'Interface {#IFNAME}'
              valuemap:
                name: 'Linux::Interface protocol types'
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
          trigger_prototypes:
            -
              expression: |
                {Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/type"].change()}<0 and {Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/type"].last()}>0
                and
                ({Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/type"].last()}=6
                or {Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/type"].last()}=1)
                and
                ({Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"].last()}<>2)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                ({Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/type"].change()}>0 and {Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/type"].prev()}>0) or
                ({Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"].last()}=2)
              name: 'Interface {#IFNAME}: Ethernet has changed to lower speed than it was before'
              opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Ack to close.'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Interface {#IFNAME}: Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and ({Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"].last()}=2 and {Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"].diff()}=1)'
                  recovery_expression: '{Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"].last()}<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
            -
              expression: |
                {Linux network interfaces by Zabbix agent active:net.if.in["{#IFNAME}",errors].min(5m)}>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or {Linux network interfaces by Zabbix agent active:net.if.out["{#IFNAME}",errors].min(5m)}>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                {Linux network interfaces by Zabbix agent active:net.if.in["{#IFNAME}",errors].max(5m)}<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and {Linux network interfaces by Zabbix agent active:net.if.out["{#IFNAME}",errors].max(5m)}<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Interface {#IFNAME}: High error rate ( > {$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'Recovers when below 80% of {$IF.ERRORS.WARN:"{#IFNAME}"} threshold'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Interface {#IFNAME}: Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and ({Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"].last()}=2 and {Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"].diff()}=1)'
                  recovery_expression: '{Linux network interfaces by Zabbix agent active:vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"].last()}<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
          graph_prototypes:
            -
              name: 'Interface {#IFNAME}: Network traffic'
              graph_items:
                -
                  drawtype: GRADIENT_LINE
                  color: 1A7C11
                  item:
                    host: 'Linux network interfaces by Zabbix agent active'
                    key: 'net.if.in["{#IFNAME}"]'
                -
                  sortorder: '1'
                  drawtype: BOLD_LINE
                  color: 2774A4
                  item:
                    host: 'Linux network interfaces by Zabbix agent active'
                    key: 'net.if.out["{#IFNAME}"]'
                -
                  sortorder: '2'
                  color: F63100
                  yaxisside: RIGHT
                  item:
                    host: 'Linux network interfaces by Zabbix agent active'
                    key: 'net.if.out["{#IFNAME}",errors]'
                -
                  sortorder: '3'
                  color: A54F10
                  yaxisside: RIGHT
                  item:
                    host: 'Linux network interfaces by Zabbix agent active'
                    key: 'net.if.in["{#IFNAME}",errors]'
                -
                  sortorder: '4'
                  color: FC6EA3
                  yaxisside: RIGHT
                  item:
                    host: 'Linux network interfaces by Zabbix agent active'
                    key: 'net.if.out["{#IFNAME}",dropped]'
                -
                  sortorder: '5'
                  color: 6C59DC
                  yaxisside: RIGHT
                  item:
                    host: 'Linux network interfaces by Zabbix agent active'
                    key: 'net.if.in["{#IFNAME}",dropped]'
      macros:
        -
          macro: '{$IF.ERRORS.WARN}'
          value: '2'
        -
          macro: '{$IFCONTROL}'
          value: '1'
        -
          macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
        -
          macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: '(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})'
          description: 'Filter out loopbacks, nulls, docker veth links and docker0 bridge by default'
      dashboards:
        -
          name: 'Network interfaces'
          widgets:
            -
              type: GRAPH_PROTOTYPE
              width: '24'
              height: '5'
              fields:
                -
                  type: INTEGER
                  name: columns
                  value: '1'
                -
                  type: INTEGER
                  name: rows
                  value: '1'
                -
                  type: INTEGER
                  name: source_type
                  value: '2'
                -
                  type: GRAPH_PROTOTYPE
                  name: graphid
                  value:
                    name: 'Interface {#IFNAME}: Network traffic'
                    host: 'Linux network interfaces by Zabbix agent active'
  triggers:
    -
      expression: '{Linux generic by Zabbix agent active:proc.num.last()}/{Linux generic by Zabbix agent active:kernel.maxproc.last()}*100>80'
      name: 'Getting closer to process limit (over 80% used)'
      opdata: '{ITEM.LASTVALUE1} active, {ITEM.LASTVALUE2} limit.'
      priority: WARNING
    -
      expression: '{Linux memory by Zabbix agent active:system.swap.size[,pfree].min(5m)}<{$SWAP.PFREE.MIN.WARN} and {Linux memory by Zabbix agent active:system.swap.size[,total].last()}>0'
      name: 'High swap space usage ( less than {$SWAP.PFREE.MIN.WARN}% free)'
      opdata: 'Free: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}'
      priority: WARNING
      description: 'This trigger is ignored, if there is no swap configured'
      dependencies:
        -
          name: 'High memory utilization ( >{$MEMORY.UTIL.MAX}% for 5m)'
          expression: '{Linux memory by Zabbix agent active:vm.memory.utilization.min(5m)}>{$MEMORY.UTIL.MAX}'
        -
          name: 'Lack of available memory ( < {$MEMORY.AVAILABLE.MIN} of {ITEM.VALUE2})'
          expression: '{Linux memory by Zabbix agent active:vm.memory.size[available].min(5m)}<{$MEMORY.AVAILABLE.MIN} and {Linux memory by Zabbix agent active:vm.memory.size[total].last()}>0'
    -
      expression: '{Linux memory by Zabbix agent active:vm.memory.size[available].min(5m)}<{$MEMORY.AVAILABLE.MIN} and {Linux memory by Zabbix agent active:vm.memory.size[total].last()}>0'
      name: 'Lack of available memory ( < {$MEMORY.AVAILABLE.MIN} of {ITEM.VALUE2})'
      opdata: 'Available: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}'
      priority: AVERAGE
    -
      expression: |
        {Linux CPU by Zabbix agent active:system.cpu.load[all,avg1].min(5m)}/{Linux CPU by Zabbix agent active:system.cpu.num.last()}>{$LOAD_AVG_PER_CPU.MAX.WARN}
        and {Linux CPU by Zabbix agent active:system.cpu.load[all,avg5].last()}>0
        and {Linux CPU by Zabbix agent active:system.cpu.load[all,avg15].last()}>0
      name: 'Load average is too high (per CPU load over {$LOAD_AVG_PER_CPU.MAX.WARN} for 5m)'
      opdata: 'Load averages(1m 5m 15m): ({ITEM.LASTVALUE1} {ITEM.LASTVALUE3} {ITEM.LASTVALUE4}), # of CPUs: {ITEM.LASTVALUE2}'
      priority: AVERAGE
      description: 'Per CPU load average is too high. Your system may be slow to respond.'
  graphs:
    -
      name: 'CPU jumps'
      graph_items:
        -
          color: 1A7C11
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: system.cpu.switches
        -
          sortorder: '1'
          color: 2774A4
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: system.cpu.intr
    -
      name: 'CPU usage'
      type: STACKED
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        -
          color: 1A7C11
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: 'system.cpu.util[,system]'
        -
          sortorder: '1'
          color: 2774A4
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: 'system.cpu.util[,user]'
        -
          sortorder: '2'
          color: F63100
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: 'system.cpu.util[,nice]'
        -
          sortorder: '3'
          color: A54F10
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: 'system.cpu.util[,iowait]'
        -
          sortorder: '4'
          color: FC6EA3
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: 'system.cpu.util[,steal]'
        -
          sortorder: '5'
          color: 6C59DC
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: 'system.cpu.util[,interrupt]'
        -
          sortorder: '6'
          color: AC8C14
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: 'system.cpu.util[,softirq]'
        -
          sortorder: '7'
          color: 611F27
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: 'system.cpu.util[,guest]'
        -
          sortorder: '8'
          color: F230E0
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: 'system.cpu.util[,guest_nice]'
    -
      name: 'CPU utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: 1A7C11
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: system.cpu.util
    -
      name: 'Memory usage'
      ymin_type_1: FIXED
      graph_items:
        -
          drawtype: BOLD_LINE
          color: 1A7C11
          item:
            host: 'Linux memory by Zabbix agent active'
            key: 'vm.memory.size[total]'
        -
          sortorder: '1'
          drawtype: GRADIENT_LINE
          color: 2774A4
          item:
            host: 'Linux memory by Zabbix agent active'
            key: 'vm.memory.size[available]'
    -
      name: 'Memory utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: 1A7C11
          item:
            host: 'Linux memory by Zabbix agent active'
            key: vm.memory.utilization
    -
      name: Processes
      graph_items:
        -
          color: 1A7C11
          item:
            host: 'Linux generic by Zabbix agent active'
            key: proc.num
        -
          sortorder: '1'
          color: 2774A4
          item:
            host: 'Linux generic by Zabbix agent active'
            key: 'proc.num[,,run]'
        -
          sortorder: '2'
          color: F63100
          item:
            host: 'Linux generic by Zabbix agent active'
            key: kernel.maxproc
    -
      name: 'Swap usage'
      graph_items:
        -
          color: 1A7C11
          item:
            host: 'Linux memory by Zabbix agent active'
            key: 'system.swap.size[,free]'
        -
          sortorder: '1'
          color: 2774A4
          item:
            host: 'Linux memory by Zabbix agent active'
            key: 'system.swap.size[,total]'
    -
      name: 'System load'
      ymin_type_1: FIXED
      graph_items:
        -
          color: 1A7C11
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: 'system.cpu.load[all,avg1]'
        -
          sortorder: '1'
          color: 2774A4
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: 'system.cpu.load[all,avg5]'
        -
          sortorder: '2'
          color: F63100
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: 'system.cpu.load[all,avg15]'
        -
          sortorder: '3'
          color: A54F10
          yaxisside: RIGHT
          item:
            host: 'Linux CPU by Zabbix agent active'
            key: system.cpu.num
  value_maps:
    -
      name: 'IF-MIB::ifOperStatus'
      mappings:
        -
          value: '1'
          newvalue: up
        -
          value: '2'
          newvalue: down
        -
          value: '4'
          newvalue: unknown
        -
          value: '5'
          newvalue: dormant
        -
          value: '6'
          newvalue: notPresent
        -
          value: '7'
          newvalue: lowerLayerDown
    -
      name: 'Linux::Interface protocol types'
      mappings:
        -
          value: '0'
          newvalue: 'from KA9Q: NET/ROM pseudo'
        -
          value: '1'
          newvalue: Ethernet
        -
          value: '2'
          newvalue: 'Experimental Ethernet'
        -
          value: '3'
          newvalue: 'AX.25 Level 2'
        -
          value: '4'
          newvalue: 'PROnet token ring'
        -
          value: '5'
          newvalue: Chaosnet
        -
          value: '6'
          newvalue: 'IEEE 802.2 Ethernet/TR/TB'
        -
          value: '7'
          newvalue: ARCnet
        -
          value: '8'
          newvalue: APPLEtalk
        -
          value: '15'
          newvalue: 'Frame Relay DLCI'
        -
          value: '19'
          newvalue: ATM
        -
          value: '23'
          newvalue: 'Metricom STRIP (new IANA id)'
        -
          value: '24'
          newvalue: 'IEEE 1394 IPv4 - RFC 2734'
        -
          value: '27'
          newvalue: EUI-64
        -
          value: '32'
          newvalue: InfiniBand
        -
          value: '256'
          newvalue: ARPHRD_SLIP
        -
          value: '257'
          newvalue: ARPHRD_CSLIP
        -
          value: '258'
          newvalue: ARPHRD_SLIP6
        -
          value: '259'
          newvalue: ARPHRD_CSLIP6
        -
          value: '260'
          newvalue: 'Notional KISS type'
        -
          value: '264'
          newvalue: ARPHRD_ADAPT
        -
          value: '270'
          newvalue: ARPHRD_ROSE
        -
          value: '271'
          newvalue: 'CCITT X.25'
        -
          value: '272'
          newvalue: 'Boards with X.25 in firmware'
        -
          value: '280'
          newvalue: 'Controller Area Network'
        -
          value: '512'
          newvalue: ARPHRD_PPP
        -
          value: '513'
          newvalue: 'Cisco HDLC'
        -
          value: '516'
          newvalue: LAPB
        -
          value: '517'
          newvalue: 'Digital''s DDCMP protocol'
        -
          value: '518'
          newvalue: 'Raw HDLC'
        -
          value: '519'
          newvalue: 'Raw IP'
        -
          value: '768'
          newvalue: 'IPIP tunnel'
        -
          value: '769'
          newvalue: 'IP6IP6 tunnel'
        -
          value: '770'
          newvalue: 'Frame Relay Access Device'
        -
          value: '771'
          newvalue: 'SKIP vif'
        -
          value: '772'
          newvalue: 'Loopback device'
        -
          value: '773'
          newvalue: 'Localtalk device'
        -
          value: '774'
          newvalue: 'Fiber Distributed Data Interface'
        -
          value: '775'
          newvalue: 'AP1000 BIF'
        -
          value: '776'
          newvalue: 'sit0 device - IPv6-in-IPv4'
        -
          value: '777'
          newvalue: 'IP over DDP tunneller'
        -
          value: '778'
          newvalue: 'GRE over IP'
        -
          value: '779'
          newvalue: 'PIMSM register interface'
        -
          value: '780'
          newvalue: 'High Performance Parallel Interface'
        -
          value: '781'
          newvalue: 'Nexus 64Mbps Ash'
        -
          value: '782'
          newvalue: 'Acorn Econet'
        -
          value: '783'
          newvalue: Linux-IrDA
        -
          value: '784'
          newvalue: 'Point to point fibrechannel'
        -
          value: '785'
          newvalue: 'Fibrechannel arbitrated loop'
        -
          value: '786'
          newvalue: 'Fibrechannel public loop'
        -
          value: '787'
          newvalue: 'Fibrechannel fabric'
        -
          value: '800'
          newvalue: 'Magic type ident for TR'
        -
          value: '801'
          newvalue: 'IEEE 802.11'
        -
          value: '802'
          newvalue: 'IEEE 802.11 + Prism2 header'
        -
          value: '803'
          newvalue: 'IEEE 802.11 + radiotap header'
        -
          value: '804'
          newvalue: ARPHRD_IEEE802154
        -
          value: '805'
          newvalue: 'IEEE 802.15.4 network monitor'
        -
          value: '820'
          newvalue: 'PhoNet media type'
        -
          value: '821'
          newvalue: 'PhoNet pipe header'
        -
          value: '822'
          newvalue: 'CAIF media type'
        -
          value: '823'
          newvalue: 'GRE over IPv6'
        -
          value: '824'
          newvalue: 'Netlink header'
        -
          value: '825'
          newvalue: 'IPv6 over LoWPAN'
        -
          value: '826'
          newvalue: 'Vsock monitor header'
